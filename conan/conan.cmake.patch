--- a/conan.cmake	Tue Jan 05 22:59:38 2021
+++ b/conan.cmake	Tue Jan 12 19:28:42 2021
@@ -296,24 +296,46 @@
 endfunction()
 
 function(conan_cmake_detect_vs_runtime result)
+    set(cmp_ninetyone OLD)
+    if(POLICY CMP0091)
+        cmake_policy(GET CMP0091 cmp_ninetyone)
+    endif()
     string(TOUPPER ${CMAKE_BUILD_TYPE} build_type)
-    set(variables CMAKE_CXX_FLAGS_${build_type} CMAKE_C_FLAGS_${build_type} CMAKE_CXX_FLAGS CMAKE_C_FLAGS)
-    foreach(variable ${variables})
-        if(NOT "${${variable}}" STREQUAL "")
-            string(REPLACE " " ";" flags ${${variable}})
-            foreach (flag ${flags})
-                if(${flag} STREQUAL "/MD" OR ${flag} STREQUAL "/MDd" OR ${flag} STREQUAL "/MT" OR ${flag} STREQUAL "/MTd")
-                    string(SUBSTRING ${flag} 1 -1 runtime)
-                    set(${result} ${runtime} PARENT_SCOPE)
-                    return()
-                endif()
-            endforeach()
+    set(static_runtime OFF)
+    if(cmp_ninetyone STREQUAL "NEW")
+        if(NOT "${CMAKE_MSVC_RUNTIME_LIBRARY}" STREQUAL "")
+            string(TOUPPER ${CMAKE_MSVC_RUNTIME_LIBRARY} runtime_library)
+            if(NOT ${runtime_library} MATCHES "DLL")
+                set(static_runtime ON)
+            endif()
         endif()
-    endforeach()
-    if(${build_type} STREQUAL "DEBUG")
-        set(${result} "MDd" PARENT_SCOPE)
     else()
-        set(${result} "MD" PARENT_SCOPE)
+        set(variables CMAKE_CXX_FLAGS_${build_type} CMAKE_C_FLAGS_${build_type} CMAKE_CXX_FLAGS CMAKE_C_FLAGS)
+        foreach(variable ${variables})
+            if(NOT "${${variable}}" STREQUAL "")
+                string(REPLACE " " ";" flags ${${variable}})
+                foreach (flag ${flags})
+                    if(${flag} STREQUAL "/MD" OR ${flag} STREQUAL "/MDd" OR ${flag} STREQUAL "/MT" OR ${flag} STREQUAL "/MTd")
+                        string(SUBSTRING ${flag} 1 -1 runtime)
+                        set(${result} ${runtime} PARENT_SCOPE)
+                        return()
+                    endif()
+                endforeach()
+            endif()
+        endforeach()
+    endif()
+    if(${static_runtime} STREQUAL "ON")
+        if(${build_type} STREQUAL "DEBUG")
+            set(${result} "MTd" PARENT_SCOPE)
+        else()
+            set(${result} "MT" PARENT_SCOPE)
+        endif()
+    else()
+        if(${build_type} STREQUAL "DEBUG")
+            set(${result} "MDd" PARENT_SCOPE)
+        else()
+            set(${result} "MD" PARENT_SCOPE)
+        endif()
     endif()
 endfunction()
 
